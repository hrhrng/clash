# Quick Reference

## ğŸš€ Supervisor Tools

### Workspace Management

```python
# Create workspace group
create_workspace_group(
    name="Character Design",
    description="Workspace for character visuals"
)
# â†’ Returns: "Created workspace group 'Character Design' with ID: alpha-ocean-square"

# List existing workspaces
list_workspace_groups()
# â†’ "Workspace groups:
#    - alpha-ocean-square: Character Design (Workspace for character visuals)"
```

### Task Delegation

```python
# Delegate without workspace (nodes at root level)
task_delegation(
    agent="ScriptWriter",
    instruction="Write a story about space exploration"
)

# Delegate with workspace (nodes inside group)
task_delegation(
    agent="ConceptArtist",
    instruction="Design a space explorer character",
    workspace_group_id="alpha-ocean-square"  # â† All nodes go here
)
```

### Canvas Tools (all available to Supervisor)

```python
# List nodes
list_canvas_nodes(node_type="text", parent_id="alpha-ocean-square")

# Read node
read_canvas_node(node_id="beta-fire-triangle")

# Create node
create_canvas_node(
    node_type="text",
    data={"label": "Notes", "content": "..."}
)

# Search
search_canvas(query="character design", node_types=["text", "prompt"])
```

## ğŸ¨ Sub-Agent Capabilities

| Agent | Workspace-Aware | Tools | Use Case |
|-------|----------------|-------|----------|
| **ScriptWriter** | âœ… Yes | list, read, create | Story outlines, character bios |
| **ConceptArtist** | âœ… Yes | list, read, create, wait_for_generation | Character/scene visualization |
| **StoryboardDesigner** | âœ… Yes | list, read, create, wait_for_generation | Shot sequences |
| **Editor** | âŒ No | list, read, timeline_editor | Video assembly |

## ğŸ“‹ Typical Workflow

### Pattern 1: Organized Workspaces

```python
# 1. Create workspace
create_workspace_group(name="Story Development")
# â†’ story-ws-id

# 2. Delegate script writing
task_delegation(
    agent="ScriptWriter",
    instruction="Write a space adventure story",
    workspace_group_id="story-ws-id"
)

# 3. Create visual workspace
create_workspace_group(name="Visual Design")
# â†’ visual-ws-id

# 4. Delegate concept art
task_delegation(
    agent="ConceptArtist",
    instruction="Create character and scene designs",
    workspace_group_id="visual-ws-id"
)

# 5. Create shots workspace
create_workspace_group(name="Storyboard Shots")
# â†’ shots-ws-id

# 6. Delegate storyboarding
task_delegation(
    agent="StoryboardDesigner",
    instruction="Create shot sequence",
    workspace_group_id="shots-ws-id"
)

# 7. Assemble video (global)
task_delegation(
    agent="Editor",
    instruction="Assemble final video"
)
```

**Result:**
```
Canvas:
â”œâ”€â”€ [Group] Story Development (story-ws-id)
â”‚   â”œâ”€â”€ [Text] Story Outline
â”‚   â””â”€â”€ [Text] Character Bio
â”œâ”€â”€ [Group] Visual Design (visual-ws-id)
â”‚   â”œâ”€â”€ [Prompt] Character Design
â”‚   â”œâ”€â”€ [Image] (generated)
â”‚   â”œâ”€â”€ [Prompt] Scene Design
â”‚   â””â”€â”€ [Image] (generated)
â””â”€â”€ [Group] Storyboard Shots (shots-ws-id)
    â”œâ”€â”€ [Prompt] Shot 1
    â”œâ”€â”€ [Image] (generated)
    â”œâ”€â”€ [Prompt] Shot 2
    â””â”€â”€ [Image] (generated)
```

### Pattern 2: Simple Task (No Workspace)

```python
# Supervisor handles simple tasks directly
create_canvas_node(
    node_type="text",
    data={"label": "Project Notes", "content": "..."}
)

# Or delegate without workspace
task_delegation(
    agent="ScriptWriter",
    instruction="Create a quick character bio"
)
# â†’ Nodes created at root level
```

### Pattern 3: Reusing Workspaces

```python
# List existing workspaces
list_workspace_groups()
# â†’ Find: alpha-ocean-square (Character Design)

# Reuse workspace for additional work
task_delegation(
    agent="ConceptArtist",
    instruction="Add another character variant",
    workspace_group_id="alpha-ocean-square"  # â† Reuse existing
)
# â†’ New nodes added to same group
```

## ğŸ”§ Node Type Reference

| Type | Description | Generated By |
|------|-------------|--------------|
| `text` | Text content | ScriptWriter, any agent |
| `prompt` | AI prompt description | ConceptArtist, StoryboardDesigner |
| `image_gen` | Image generation task | ConceptArtist, StoryboardDesigner |
| `video_gen` | Video generation task | StoryboardDesigner |
| `group` | Workspace/container | Supervisor (via create_workspace_group) |

## ğŸ¯ Best Practices

### âœ… Do

- **Create workspaces** for multi-step tasks
- **Scope sub-agents** to workspaces for organization
- **Reuse workspaces** when adding related content
- **Let Editor work globally** (no workspace)
- **Use descriptive workspace names**

### âŒ Don't

- Don't create workspaces for single-node tasks
- Don't forget to wait for generation completion
- Don't manually specify parent_id for workspace-aware agents
- Don't scope Editor to a workspace (it needs global access)

## ğŸ› Troubleshooting

### Nodes Not Appearing in Workspace

**Problem:** Sub-agent creates nodes at root level instead of in workspace

**Solution:** Check that:
1. Agent is `workspace_aware=True` in definition
2. `workspace_group_id` is passed in `task_delegation`
3. Sub-agent is not manually overriding `parent_id`

### Workspace Not Created

**Problem:** `create_workspace_group` doesn't emit SSE event

**Solution:** Ensure LangGraph is streaming with `stream_mode=["custom"]`

### Generation Tasks Hanging

**Problem:** Image/video generation never completes

**Solution:**
1. Agent must call `wait_for_generation(node_id)`
2. Check that frontend is updating asset status
3. Verify context is synced via POST `/api/v1/project/context`

## ğŸ“š Further Reading

- [WORKSPACE_SCOPING.md](WORKSPACE_SCOPING.md) - Detailed feature guide
- [INTEGRATION.md](INTEGRATION.md) - Integration with SSE + context
- [README.md](README.md) - Full architecture overview
- [ARCHITECTURE_SUMMARY.md](ARCHITECTURE_SUMMARY.md) - Quick summary
